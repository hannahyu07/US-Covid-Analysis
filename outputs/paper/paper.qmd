---
title: "How did local health infrastructure and socio-political factors within different states and counties in the United States affect the disparities in COVID-19 outcomes, and what lessons can be learned for more targeted public health preparedness and response strategies in future pandemics?"
author: 
  - Adrian Ly
  - Sakhil Goel
  - Hannah Yu
thanks: "Code and data are available at: https://github.com/hannahyu07/US-Covid-Analysis.git"
date: today
date-format: long
abstract: "First sentence. Second sentence. Third sentence. Fourth sentence."
format: pdf
number-sections: true
toc: true
bibliography: references.bib
---

```{r}
#| include: false
#| warning: false
#| message: false

#### Workspace setup ####
library(tidyverse)
library(sf)
library(readxl)
library(knitr)
library(janitor)
library(lubridate)
library(dplyr)
library(data.table)
library(RColorBrewer)
library(ggpubr)
library(scales)
library(here)
library(kableExtra)


#### Reading files ####

ghs_data <- read_excel(here::here("inputs/data/GHS_index.xlsx"))
world_map <- st_read(here::here("inputs/data/world/World_Countries__Generalized_.shp"))
life_exp <- read.csv(here::here("inputs/data/life_table.csv"), stringsAsFactors = FALSE)
vote_share <- read.csv(here::here("inputs/data/Vote_share_2020_data.csv"), stringsAsFactors = FALSE)
deaths <- read.csv(here::here("inputs/data/covid-19-death-rates.csv"), stringsAsFactors = FALSE)


```


# Introduction

*This reproduction was performed after a replication on the Social Science Reproduction platform: ****[link here](https://www.socialsciencereproduction.org/reproductions/c35e8e98-762d-4c00-a1a3-544ed0b2008d/index)***

# Data {#sec-data}



## Source

The datasets utilized in this paper were mainly obtained from the `original paper` [@citearticle]. Additionally, to address the original paper's lack of US Covid statistics and political party support data, we incorporated information from @citedata1 and @citedata2.

@citedata1 discusses the long-term impacts of COVID-related school closures. From this source, we utilized the dataset on voting shares during the 2020 election by county.
@citedata2 provides summaries of COVID-19 death rates in the United States as of March 2023, organized by state. Analyzing results from both datasets allows us to explore the relationship between political affiliation and COVID-19 outcomes.Our reproduction aims to fill these gaps and also includes tables and graphs that were not presented in the original paper to support our findings.


## Methodology

`R` [@citeR] was the language and environment used for the bulk of this analysis, alongside `tidyverse` [@citeTidyVerse], `sf` [@citeSF], `readxl` [@citeReadXL], `knitr` [@citeKnitR], `janitor` [@citeJanitor], `lubridate` [@citeLubridate], `dplyr` [@citeDplyr], `data.table` [@citeDataTable], `RColorBrewer` [@citeRColorBrewer], `ggpubr` [@citeggpubr], `ggplot2` [@citeggplot], `here` [@citeHere], `kableExtra` [@citeKableExtra], `webshot` [@citewebshot], `webshot2` [@citewebshot2], and `scales` [@citeScales].  

## Data Measurement

## Data cleaning

## Data Visualization


```{r}
#| echo: false
#| eval: true
#| label: fig-GHS
#| fig-cap: Global Health Security Index Scores by Country
#| warning: false

ghs_data <- ghs_data %>%
  mutate(COUNTRY = case_when(
    Country == "United States of America" ~ "United States",
    Country == "Bolivia (Plurinational State of)" ~ "Bolivia",
    # Add other necessary name changes here
    TRUE ~ Country
  ))

world_ghs <- merge(world_map, ghs_data, by.x = "COUNTRY", by.y = "COUNTRY", all.x = TRUE)


ggplot(data = world_ghs) +
  geom_sf(aes(fill = `OVERALL SCORE`), color = "white") +
  scale_fill_distiller(palette = "Spectral", na.value = "lightgrey", 
                       name = "GHS Index Score", direction = 1,
                       limits = c(min(ghs_data$`OVERALL SCORE`, na.rm = TRUE), max(ghs_data$`OVERALL SCORE`, na.rm = TRUE)),
                       labels = comma) +  # Use comma to format numbers with commas
  theme_minimal() +
  theme(legend.position = "bottom",
        plot.title = element_text(hjust = 0.5))

```


# Results

Our results are summarized in @fig-GHS.

```{r fig.width=7, fig.height=3.5}
#| echo: false
#| eval: true
#| label: fig-ELE
#| fig-cap: Estimates of Life Expectancy at Birth, by Race 2006-2021
#| warning: false


# Reshape the data if necessary
life_exp_melted <- reshape(
  life_exp,
  idvar = "year_id",
  varying = list(names(life_exp)[-1]), 
  v.names = "life_exp",
  times = names(life_exp)[-1],
  new.row.names = 1:1e5,
  direction = "long"
)
life_exp_melted$race <- gsub("_", " ", life_exp_melted$time)  # Convert "_" to " " in race names
life_exp_melted <- life_exp_melted[, c("year_id", "race", "life_exp")]

life_exp_melted[life_exp_melted$race == 'All', "race"] <- 'All races and origins'

## CREATE PANEL A
est_life <- ggplot(data = life_exp_melted[!(life_exp_melted$race %like% 'AIAN|Asian'), ], aes(x = year_id, y = life_exp, color = race)) +
  geom_point(shape = 16, size = 3.5, alpha = 0.9) +  # Circular points with size 2
  geom_line(aes(group = race), alpha = 0.56, size = 1.5) +  # Add group aesthetic for lines
  scale_y_continuous(name = 'Life expectancy at birth', limits = c(65, 85)) +
  scale_x_continuous(name = '', breaks = seq(2006, 2020, by = 2), limits = c(2005.5, 2021.5)) +
  scale_color_manual(values = c('#0c4928', '#0b3669', '#4c2962', '#5a0f1c'), 
                     labels = c("All races and origins", "Hispanic", "Black", "White")) +
  # Darker color values
  theme_minimal() +
  theme(axis.title = element_text(size = 14),  # Adjusting the size of the y-axis label
        axis.text = element_text(size = 12),
        legend.position = 'bottom',  # Set legend position to bottom
        legend.justification = 'center',  # Center the legend
        legend.text = element_text(size = 10),  # Adjusting the font size for legend text
        legend.title = element_text(size = 12, face = 'bold')) +
  labs(color = "Race:")  # Set the legend title

est_life

```


```{r}
#| echo: false
#| eval: true
#| warning: false
# Create a dataframe to store the changes by race
change_by_race <- data.frame(
  race = c("All races and origins", "Hispanic", "American Indians and Alaska Native", "Asian", "Black", "White"),
  change_2020_2019 = c(77 - 78.8, 77.9 - 81.9, 67.1 - 71.8, 83.6 - 85.6, 71.5 - 74.8, 77.4 - 78.8),
  change_2021_2020 = c(76.1 - 77, 77.7 - 77.9, 65.2 - 67.1, 83.5 - 83.6, 70.8 - 71.5, 76.4 - 77.4)
)


```

```{r fig.width=8, fig.height=4}
#| echo: false
#| eval: true
#| label: fig-CLE
#| fig-cap: Change in Life Expectancy at Birth from the Previous Year
#| warning: false


# Melt the dataframe
tmp <- melt(change_by_race, id.vars = "race", measure.vars = c("change_2020_2019", "change_2021_2020"), 
             variable.name = "period", value.name = "diff")

# Create PANEL B
change_life_exp <- ggplot(data = tmp, aes(x = race, y = diff, fill = period)) +
  geom_bar(stat = "identity", position = "dodge", alpha = 0.71) +
  scale_y_continuous(name = "Change (years)", breaks = -5:0, limits = c(-5.5, 0)) +
  scale_fill_manual(name = "Time period", values = c('#243f29', '#186d38'), labels = c('2019-2020', '2020-2021')) + 
  scale_color_manual(name = "Time period", values = c('#243f29', '#186d38'), labels = c('2019-2020', '2020-2021')) + 
  theme_minimal() + labs(x = '') +
  geom_text(aes(label = sprintf("%.1f", diff)), position = position_dodge(width = 0.9), vjust = 1.3, size = 4) +
  theme(
    axis.title = element_text(size = 14),
    axis.text.x = element_text(size = 10, hjust = 1),
    axis.text.y = element_text(size = 8),
    legend.text = element_text(size = 12),
    legend.title = element_text(size = 12, face = 'bold')) + 
    scale_x_discrete(labels = function(x) str_wrap(x, width = 15))


change_life_exp

```


```{r}
#| echo: false
#| eval: true
#| warning: false

vote_data_by_state <- vote_share %>%
  group_by(state_name) %>%
  summarize(
    total_votes = sum(total_votes),
    total_gop_votes = sum(votes_gop),
    total_dem_votes = sum(votes_dem),
    total_diff = sum(diff),
    avg_per_gop = mean(per_gop),
    avg_per_dem = mean(per_dem),
    avg_per_point_diff = mean(per_point_diff)
  )

vote_data_by_state <- vote_data_by_state |>
  mutate(gop_greater = if_else(total_gop_votes > total_dem_votes, 1, 0))

```


```{r}
#| echo: false
#| eval: true
#| label: fig-Vote
#| fig-cap: Total Number of Votes in Top 10 States with Highest Proportion of Republican Votes 
#| warning: false

# Create plot summarizing total number of votes by top 10 republican state
#sorted_states <- vote_data_by_state[order(-vote_data_by_state$total_diff), ]


# Calculate proportion of Republican votes
sorted_states <- vote_data_by_state
sorted_states$proportion_republican <- sorted_states$total_gop_votes / sorted_states$total_votes

# Sort by proportion of Republican votes
sorted_states <- sorted_states[order(-sorted_states$proportion_republican), ]

# Select top 10 states
top_10_states <- head(sorted_states, 10)


# Extract the top 10 states with the biggest difference
top_10_states <- head(sorted_states, 10)
# Create a data frame for plotting
plot_data <- data.frame(
  state_name = top_10_states$state_name,
  republican_votes = top_10_states$total_gop_votes,
  democrat_votes = top_10_states$total_dem_votes
)

# Convert data to long format for ggplot
plot_data_long <- tidyr::pivot_longer(plot_data, cols = c(republican_votes, democrat_votes), names_to = "party", values_to = "votes")

# Create the stacked bar plot
ggplot(plot_data_long, aes(x = state_name, y = votes, fill = party)) +
  geom_bar(stat = "identity") +
  labs(title = "Total Number of Votes by Top 10 Republican State", x = "State", y = "Total Votes", fill = "Party") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1)) +
  scale_fill_manual(values = c("republican_votes" = "red", "democrat_votes" = "blue"),
                    labels = c("Democratic Votes", "Republican Votes"))

```


```{r}
#| echo: false
#| eval: true
#| label: tbl-deaths
#| tbl-cap: Top 10 States with Highest Death Rates from COVID-19 (per 100,000 people)
#| warning: false

# Assign column names
colnames(deaths) <- c("State", "Death_Rate")

# Rank the states based on death rate
deaths <- deaths[order(-deaths$Death_Rate), ]
deaths$Rank <- 1:nrow(deaths)

# Create the table
table <- head(data.frame(Rank = deaths$Rank, State = deaths$State, Deaths = deaths$Death_Rate), 10)

# Print the table using kableExtra
kable(table, caption = "Top 10 States with Highest Death Rates from COVID-19 (per 100,000 people)", align = "c") %>%
  kable_styling(full_width = FALSE)

```

\newpage




# Discussion

This begs the question as to why we are seeing these results. There isn't exactly a single answer to this question, however we can certainly point out some considerable factors to this result. 

## Influence of political polarization on adherence to health guidelines.

Political polarization has significantly impacted the adherence to health guidelines during the COVID-19 pandemic. The divergence in political ideologies has translated into differing attitudes towards health directives, including mask mandates, social distancing, and vaccination uptake. 

Various studies and our own results have shown that areas with higher support for one political party exhibited distinct behaviors and compliance levels with health recommendations, which directly correlated with COVID-19 case rates and mortality. An news article from `ABC News` [@citesource1] shows that the top states with the highest COVID-19 deaths are Arizona, and Washington with 581 deaths and 526 deaths respectively per 100,000 people. According to 2020 presidential voting data published by `CNN`, we have both states having the electoral vote of democrat with Washington wining by 58% [@citesource2] and Arizona winning by 49.4% [@citesource3]. Another news article by `ContagionLive` [@citesource4] also makes the claim of both Arizona and Washington having the highest COVID-19 mortality. This polarization has not only influenced individual behavior but also shaped state and local health policies, further entrenching the disparities in health outcomes. 

The adherence to health guidelines are evident in the varied health outcomes observed across the United States. Regions with lower compliance to health directives, often influenced by political leanings, have experienced higher rates of COVID-19 transmission, hospitalizations, and deaths. The disparities in vaccine uptake, driven by political affiliations, have further exacerbated these outcomes, leaving certain communities more vulnerable to the virus and its variants. In order to mitigate the influence of political polarization on public health, it is imperative to depoliticize health guidelines and focus on evidence-based approaches to disease prevention and control. Building trust in health institutions and promoting bipartisan support for public health measures are essential steps towards achieving higher compliance and better health outcomes. Engaging trusted community leaders and utilizing targeted communication strategies can also help bridge the divide and encourage adherence to health guidelines.

## Impact of government transparency and consistent communication on public trust.

The politicization of health guidelines and mixed messages from political and health leaders during the COVID-19 pandemic have significantly undermined the effectiveness of public health messaging, leading to confusion, skepticism, and eroded trust among the public. Initially, inconsistencies in recommendations, such as on mask usage, challenged the principle of clear, consistent, and science-based communication essential for an effective public health response. Moreover, the transparency of government actions and decision-making processes is crucial in building and maintaining public trust, especially during health crises. The level of public trust was greatly affected by the openness and accuracy with which governments, at all levels, communicated about the evolving situation, the reasoning behind guidelines, and the measures taken to combat the virus, emphasizing the importance of transparent reporting of data related to case counts, hospitalizations, vaccine distribution, and side effects. Furthermore, consistent communication from public health officials and government leaders is key to ensuring adherence to health guidelines, where inconsistencies, such as changes in mask-wearing guidelines without clear explanations, have led to public confusion. The direct correlation between government transparency, consistent communication, and public behavior is self-evident, with populations receiving clear and transparent information being more likely to adhere to guidelines, participate in testing and tracing efforts, and accept vaccination. Drawing lessons from the pandemic, strategies for improving government transparency and communication in future health emergencies should include establishing centralized information hubs, ensuring regular and predictable communication from health authorities, engaging community leaders in information dissemination, and harnessing digital platforms and social media to amplify public health messages, thus reinforcing public trust and compliance.

## Role of social vulnerabilities and healthcare access disparities in pandemic impact.

## Strategies for improving real-time data collection and sharing for public health decisions.

## Weaknesses and next stepsa

Weaknesses and next steps should also be included.

\newpage

# References


